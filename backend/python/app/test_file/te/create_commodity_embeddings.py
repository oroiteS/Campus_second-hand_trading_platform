import chromadb
import numpy as np
all_data = [
    ['01234567-89ab-7def-8123-456789abcde0', 2, [3], 'T20210003'],
    ['01234567-89ab-7def-8123-456789abcde1', 3, [4, 5], 'S20210002'],
    ['01234567-89ab-7def-8123-456789abcde2', 4, [6], 'T20210005'],
    ['01234567-89ab-7def-8123-456789abcde3', 5, [7], 'S20210004'],
    ['01234567-89ab-7def-8123-456789abcde4', 6, [8], 'T20210007'],
    ['01234567-89ab-7def-8123-456789abcde5', 7, [9], 'S20210006'],
    ['01234567-89ab-7def-8123-456789abcde6', 8, [10], 'S20210008'],
    ['01234567-89ab-7def-8123-456789abcdef', 1, [1, 2], 'S20210001'],
    ['2354218b-4c42-11f0-919e-00163e0c1add', 1, [9, 10, 11, 49, 90], 'U10000001'],
    ['235426ae-4c42-11f0-919e-00163e0c1add', 1, [13, 49, 91, 72], 'U10000001'],
    ['23542826-4c42-11f0-919e-00163e0c1add', 1, [12, 49, 93], 'U10000001'],
    ['23542a16-4c42-11f0-919e-00163e0c1add', 1, [22, 23, 49, 91], 'U10000001'],
    ['23542b55-4c42-11f0-919e-00163e0c1add', 1, [28, 29, 32, 90], 'U10000001'],
    ['23542dd0-4c42-11f0-919e-00163e0c1add', 1, [2, 41, 42, 91], 'U10000001'],
    ['23542ed7-4c42-11f0-919e-00163e0c1add', 1, [3, 4, 5, 90], 'U10000001'],
    ['23542fcd-4c42-11f0-919e-00163e0c1add', 1, [43, 44, 50, 92], 'U10000001'],
    ['235430d2-4c42-11f0-919e-00163e0c1add', 1, [30, 31, 51, 54, 91], 'U10000001'],
    ['235431ba-4c42-11f0-919e-00163e0c1add', 1, [10, 11, 51, 90], 'U10000001'],
    ['235432a8-4c42-11f0-919e-00163e0c1add', 1, [14, 15, 16, 49, 72, 91], 'U10000001'],
    ['23543391-4c42-11f0-919e-00163e0c1add', 1, [18, 19, 49, 91], 'U10000001'],
    ['2354347c-4c42-11f0-919e-00163e0c1add', 1, [37, 38, 93], 'U10000001'],
    ['2354355f-4c42-11f0-919e-00163e0c1add', 1, [39, 40, 90], 'U10000001'],
    ['2354363b-4c42-11f0-919e-00163e0c1add', 1, [87, 88, 93], 'U10000001'],
    ['23543713-4c42-11f0-919e-00163e0c1add', 1, [57, 58, 59, 51, 92], 'U10000001'],
    ['235437f2-4c42-11f0-919e-00163e0c1add', 1, [2, 35, 36, 93], 'U10000001'],
    ['235438d9-4c42-11f0-919e-00163e0c1add', 1, [45, 46, 50, 91], 'U10000001'],
    ['235439b2-4c42-11f0-919e-00163e0c1add', 1, [47, 48, 50, 90], 'U10000001'],
    ['23543a9b-4c42-11f0-919e-00163e0c1add', 1, [20, 21, 49, 91], 'U10000001'],
    ['23543b75-4c42-11f0-919e-00163e0c1add', 1, [24, 49, 91], 'U10000001'],
    ['23543c70-4c42-11f0-919e-00163e0c1add', 1, [26, 27, 49, 91], 'U10000001'],
    ['23543d48-4c42-11f0-919e-00163e0c1add', 1, [52, 53, 49, 73, 92], 'U10000001'],
    ['23543e1d-4c42-11f0-919e-00163e0c1add', 1, [61, 51, 91], 'U10000001'],
    ['23543ef4-4c42-11f0-919e-00163e0c1add', 1, [49, 67, 78, 90], 'U10000001'],
    ['23543fdd-4c42-11f0-919e-00163e0c1add', 1, [49, 79, 81, 91], 'U10000001'],
    ['235440b4-4c42-11f0-919e-00163e0c1add', 1, [17, 49, 92], 'U10000001'],
    ['235685dd-4c42-11f0-919e-00163e0c1add', 2, [110, 130, 139, 154], 'U10000001'],
    ['2356892b-4c42-11f0-919e-00163e0c1add', 2, [111, 130, 152], 'U10000001'],
    ['23568a6c-4c42-11f0-919e-00163e0c1add', 2, [112, 130, 131, 155], 'U10000001'],
    ['23568b6c-4c42-11f0-919e-00163e0c1add', 2, [115, 132, 133, 153], 'U10000001'],
    ['23568c5f-4c42-11f0-919e-00163e0c1add', 2, [123, 139, 154], 'U10000001'],
    ['23568d58-4c42-11f0-919e-00163e0c1add', 2, [127, 139, 154], 'U10000001'],
    ['23568e3d-4c42-11f0-919e-00163e0c1add', 2, [99, 141, 143], 'U10000001'],
    ['23568f1c-4c42-11f0-919e-00163e0c1add', 2, [100, 135, 150, 153], 'U10000001'],
    ['23568ff8-4c42-11f0-919e-00163e0c1add', 2, [106, 135, 148, 154], 'U10000001'],
    ['235690eb-4c42-11f0-919e-00163e0c1add', 2, [106, 135, 149, 154], 'U10000001'],
    ['235691c9-4c42-11f0-919e-00163e0c1add', 2, [97, 101, 142, 153], 'U10000001'],
    ['235692a5-4c42-11f0-919e-00163e0c1add', 2, [95, 144, 154], 'U10000001'],
    ['2356937d-4c42-11f0-919e-00163e0c1add', 2, [113, 130, 131, 152], 'U10000001'],
    ['2356945b-4c42-11f0-919e-00163e0c1add', 2, [104, 135, 138, 154], 'U10000001'],
    ['23569532-4c42-11f0-919e-00163e0c1add', 2, [122, 131, 140, 155], 'U10000001'],
    ['2356960c-4c42-11f0-919e-00163e0c1add', 2, [108, 154], 'U10000001'],
    ['235696e4-4c42-11f0-919e-00163e0c1add', 2, [109, 144, 153], 'U10000001'],
    ['235697d6-4c42-11f0-919e-00163e0c1add', 2, [124, 139, 154], 'U10000001'],
    ['235698ae-4c42-11f0-919e-00163e0c1add', 2, [135, 145, 147, 154], 'U10000001'],
    ['23569a5b-4c42-11f0-919e-00163e0c1add', 2, [121, 152], 'U10000001'],
    ['23569b3f-4c42-11f0-919e-00163e0c1add', 2, [158, 140, 154], 'U10000001'],
    ['23569c1b-4c42-11f0-919e-00163e0c1add', 2, [143, 153], 'U10000001'],
    ['23569cfe-4c42-11f0-919e-00163e0c1add', 2, [107, 142, 155], 'U10000001'],
    ['23569dd9-4c42-11f0-919e-00163e0c1add', 2, [161, 140, 154], 'U10000001'],
    ['2356b984-4c42-11f0-919e-00163e0c1add', 2, [102, 135, 153], 'U10000001'],
    ['23591975-4c42-11f0-919e-00163e0c1add', 3, [188, 223, 204], 'U10000001'],
    ['23591c78-4c42-11f0-919e-00163e0c1add', 3, [190], 'U10000001'],
    ['23591db4-4c42-11f0-919e-00163e0c1add', 3, [192], 'U10000001'],
    ['23591eba-4c42-11f0-919e-00163e0c1add', 3, [193, 194], 'U10000001'],
    ['23591fb2-4c42-11f0-919e-00163e0c1add', 3, [196], 'U10000001'],
    ['235920b1-4c42-11f0-919e-00163e0c1add', 3, [225], 'U10000001'],
    ['23592191-4c42-11f0-919e-00163e0c1add', 3, [252, 33, 34], 'U10000001'],
    ['23592276-4c42-11f0-919e-00163e0c1add', 3, [169, 661], 'U10000001'],
    ['23592356-4c42-11f0-919e-00163e0c1add', 3, [210, 177], 'U10000001'],
    ['23592436-4c42-11f0-919e-00163e0c1add', 3, [166, 170, 171, 239], 'U10000001'],
    ['23592518-4c42-11f0-919e-00163e0c1add', 3, [187, 206], 'U10000001'],
    ['235925f4-4c42-11f0-919e-00163e0c1add', 3, [221], 'U10000001'],
    ['235926d8-4c42-11f0-919e-00163e0c1add', 3, [197], 'U10000001'],
    ['235927b5-4c42-11f0-919e-00163e0c1add', 3, [199], 'U10000001'],
    ['2359288d-4c42-11f0-919e-00163e0c1add', 3, [202], 'U10000001'],
    ['2359297d-4c42-11f0-919e-00163e0c1add', 3, [203], 'U10000001'],
    ['23592a59-4c42-11f0-919e-00163e0c1add', 3, [214], 'U10000001'],
    ['23592b2f-4c42-11f0-919e-00163e0c1add', 3, [213], 'U10000001'],
    ['23592c06-4c42-11f0-919e-00163e0c1add', 3, [251, 33, 34], 'U10000001'],
    ['23592ce7-4c42-11f0-919e-00163e0c1add', 3, [174, 175, 176], 'U10000001'],
    ['23592dc1-4c42-11f0-919e-00163e0c1add', 3, [208, 663], 'U10000001'],
    ['23592ea0-4c42-11f0-919e-00163e0c1add', 3, [182, 239], 'U10000001'],
    ['23592f80-4c42-11f0-919e-00163e0c1add', 3, [216], 'U10000001'],
    ['2359305e-4c42-11f0-919e-00163e0c1add', 3, [238], 'U10000001'],
    ['2359313f-4c42-11f0-919e-00163e0c1add', 3, [242, 177, 287], 'U10000001'],
    ['23593217-4c42-11f0-919e-00163e0c1add', 3, [253], 'U10000001'],
    ['235c5946-4c42-11f0-919e-00163e0c1add', 6, [547, 563, 579, 582], 'U10000001'],
    ['235c5c63-4c42-11f0-919e-00163e0c1add', 6, [548, 567, 577, 601], 'U10000001'],
    ['235c5dab-4c42-11f0-919e-00163e0c1add', 6, [549, 563, 580, 602], 'U10000001'],
    ['235c5eba-4c42-11f0-919e-00163e0c1add', 6, [552, 564, 582], 'U10000001'],
    ['235c75cf-4c42-11f0-919e-00163e0c1add', 6, [557, 573], 'U10000001'],
    ['235c7754-4c42-11f0-919e-00163e0c1add', 6, [555, 573], 'U10000001'],
    ['235c786b-4c42-11f0-919e-00163e0c1add', 6, [558, 588, 625], 'U10000001'],
    ['235c7972-4c42-11f0-919e-00163e0c1add', 6, [570], 'U10000001'],
    ['235c7a69-4c42-11f0-919e-00163e0c1add', 6, [550, 563, 582], 'U10000001'],
    ['235c7b5e-4c42-11f0-919e-00163e0c1add', 6, [554, 565, 577], 'U10000001'],
    ['235c7c55-4c42-11f0-919e-00163e0c1add', 6, [560, 564, 581, 678, 680], 'U10000001'],
    ['235c7d51-4c42-11f0-919e-00163e0c1add', 6, [575], 'U10000001'],
    ['235c7e42-4c42-11f0-919e-00163e0c1add', 6, [576, 680], 'U10000001'],
    ['235c7f3a-4c42-11f0-919e-00163e0c1add', 6, [572, 580, 681], 'U10000001'],
    ['235c802e-4c42-11f0-919e-00163e0c1add', 6, [564, 577, 680], 'U10000001'],
    ['235c8120-4c42-11f0-919e-00163e0c1add', 6, [589], 'U10000001'],
    ['235c8208-4c42-11f0-919e-00163e0c1add', 6, [590, 630], 'U10000001'],
    ['235c8308-4c42-11f0-919e-00163e0c1add', 6, [574], 'U10000001'],
    ['235c83f4-4c42-11f0-919e-00163e0c1add', 6, [615, 583], 'U10000001'],
    ['235c84e2-4c42-11f0-919e-00163e0c1add', 6, [647], 'U10000001'],
    ['235c85d7-4c42-11f0-919e-00163e0c1add', 6, [569, 607, 677], 'U10000001'],
    ['235c86b8-4c42-11f0-919e-00163e0c1add', 6, [573], 'U10000001'],
    ['235c8799-4c42-11f0-919e-00163e0c1add', 6, [551, 564, 582, 579], 'U10000001'],
    ['235c887b-4c42-11f0-919e-00163e0c1add', 6, [568, 679], 'U10000001'],
    ['235c8962-4c42-11f0-919e-00163e0c1add', 6, [658], 'U10000001'],
    ['235c8a3c-4c42-11f0-919e-00163e0c1add', 6, [666, 667], 'U10000001'],
    ['235edc62-4c42-11f0-919e-00163e0c1add', 4, [315, 317, 318], 'U10000001'],
    ['235edf85-4c42-11f0-919e-00163e0c1add', 4, [313, 319, 320], 'U10000001'],
    ['235ee0b9-4c42-11f0-919e-00163e0c1add', 4, [321], 'U10000001'],
    ['235ee1c1-4c42-11f0-919e-00163e0c1add', 4, [323], 'U10000001'],
    ['235ee2bf-4c42-11f0-919e-00163e0c1add', 4, [324], 'U10000001'],
    ['235ee3b6-4c42-11f0-919e-00163e0c1add', 4, [334, 355], 'U10000001'],
    ['235ee4a3-4c42-11f0-919e-00163e0c1add', 4, [329], 'U10000001'],
    ['235ee58e-4c42-11f0-919e-00163e0c1add', 4, [330], 'U10000001'],
    ['235ee670-4c42-11f0-919e-00163e0c1add', 4, [331], 'U10000001'],
    ['235ee752-4c42-11f0-919e-00163e0c1add', 4, [335, 353], 'U10000001'],
    ['235ee83a-4c42-11f0-919e-00163e0c1add', 4, [365], 'U10000001'],
    ['235ee917-4c42-11f0-919e-00163e0c1add', 4, [369], 'U10000001'],
    ['235ee9f4-4c42-11f0-919e-00163e0c1add', 4, [326], 'U10000001'],
    ['235eeadb-4c42-11f0-919e-00163e0c1add', 4, [376], 'U10000001'],
    ['235eebbb-4c42-11f0-919e-00163e0c1add', 4, [377], 'U10000001'],
    ['235eeca5-4c42-11f0-919e-00163e0c1add', 4, [325], 'U10000001'],
    ['235eed88-4c42-11f0-919e-00163e0c1add', 4, [368], 'U10000001'],
    ['235eee66-4c42-11f0-919e-00163e0c1add', 4, [339], 'U10000001'],
    ['235eef4a-4c42-11f0-919e-00163e0c1add', 4, [358], 'U10000001'],
    ['235ef029-4c42-11f0-919e-00163e0c1add', 4, [336], 'U10000001'],
    ['235ef101-4c42-11f0-919e-00163e0c1add', 4, [340], 'U10000001'],
    ['235ef1de-4c42-11f0-919e-00163e0c1add', 4, [382], 'U10000001'],
    ['235ef2c4-4c42-11f0-919e-00163e0c1add', 4, [333, 354], 'U10000001'],
    ['235ef3a1-4c42-11f0-919e-00163e0c1add', 4, [383], 'U10000001'],
    ['235ef482-4c42-11f0-919e-00163e0c1add', 4, [316], 'U10000001'],
    ['236153b6-4c42-11f0-919e-00163e0c1add', 5, [385, 415, 449], 'U10000001'],
    ['236156ca-4c42-11f0-919e-00163e0c1add', 5, [386, 416, 525, 526], 'U10000001'],
    ['23615807-4c42-11f0-919e-00163e0c1add', 5, [386, 416, 486], 'U10000001'],
    ['23615911-4c42-11f0-919e-00163e0c1add', 5, [397, 427, 449], 'U10000001'],
    ['23615a0b-4c42-11f0-919e-00163e0c1add', 5, [398, 428, 451], 'U10000001'],
    ['23615b10-4c42-11f0-919e-00163e0c1add', 5, [401, 472], 'U10000001'],
    ['23615bf9-4c42-11f0-919e-00163e0c1add', 5, [412, 476], 'U10000001'],
    ['23615ce0-4c42-11f0-919e-00163e0c1add', 5, [474], 'U10000001'],
    ['23615dcd-4c42-11f0-919e-00163e0c1add', 5, [392, 422, 491], 'U10000001'],
    ['23616074-4c42-11f0-919e-00163e0c1add', 5, [412, 477], 'U10000001'],
    ['2361618a-4c42-11f0-919e-00163e0c1add', 5, [395, 425, 453], 'U10000001'],
    ['2361627c-4c42-11f0-919e-00163e0c1add', 5, [385, 415, 434], 'U10000001'],
    ['23617a13-4c42-11f0-919e-00163e0c1add', 5, [540, 541], 'U10000001'],
    ['23617b80-4c42-11f0-919e-00163e0c1add', 5, [507], 'U10000001'],
    ['23617c90-4c42-11f0-919e-00163e0c1add', 5, [463, 531], 'U10000001'],
    ['23617d8d-4c42-11f0-919e-00163e0c1add', 5, [386, 416, 440], 'U10000001'],
    ['23617e8a-4c42-11f0-919e-00163e0c1add', 5, [391, 421, 493], 'U10000001'],
    ['23617f7e-4c42-11f0-919e-00163e0c1add', 5, [461], 'U10000001'],
    ['23618074-4c42-11f0-919e-00163e0c1add', 5, [460, 499, 502], 'U10000001'],
    ['2361817d-4c42-11f0-919e-00163e0c1add', 5, [406, 470, 471], 'U10000001'],
    ['2361826d-4c42-11f0-919e-00163e0c1add', 5, [430], 'U10000001'],
    ['23618358-4c42-11f0-919e-00163e0c1add', 5, [475], 'U10000001'],
    ['2361843b-4c42-11f0-919e-00163e0c1add', 5, [432, 433], 'U10000001'],
    ['23618522-4c42-11f0-919e-00163e0c1add', 5, [386, 416], 'U10000001'],
    ['23618603-4c42-11f0-919e-00163e0c1add', 5, [511], 'U10000001']
]

client = chromadb.PersistentClient('./embedding_folder')
collection_commodity = client.get_or_create_collection('commodities')
collection_tag = client.get_or_create_collection('tags')
collection_category = client.get_or_create_collection('categories')
for data in all_data:
    tag_embedding = np.zeros(2560)
    print(f"category_{data[1]}")
    category_results = collection_category.get(
        ids=[f"category_{data[1]}"],
        include=['embeddings']
    )
    category_embedding = np.array(category_results['embeddings'][0])
    for tid in data[2]:
        tag_embedding += np.array(collection_tag.get(
            where={"tag_id": tid},
            include=['embeddings']
        )['embeddings'][0])
    embedding_sum = category_embedding + tag_embedding
    embedding_sum = embedding_sum.tolist()
    collection_commodity.upsert(
        ids = [data[0]],
        embeddings = [embedding_sum],
        metadatas = [
            {
                'seller_id':data[3],
            }
        ]
    )
