import chromadb
import numpy as np
all_data = [
    ['2748e13e-4c3f-11f0-8a67-9c2dcd12e445', 1, [9, 10, 11, 49, 90], 'U10000001'],
    ['2749157e-4c3f-11f0-8a67-9c2dcd12e445', 1, [13, 49, 91, 72], 'U10000001'],
    ['2749179b-4c3f-11f0-8a67-9c2dcd12e445', 1, [12, 49, 93], 'U10000001'],
    ['274919f9-4c3f-11f0-8a67-9c2dcd12e445', 1, [22, 23, 49, 91], 'U10000001'],
    ['27491bab-4c3f-11f0-8a67-9c2dcd12e445', 1, [28, 29, 32, 90], 'U10000001'],
    ['27491f8f-4c3f-11f0-8a67-9c2dcd12e445', 1, [2, 41, 42, 91], 'U10000001'],
    ['274920e7-4c3f-11f0-8a67-9c2dcd12e445', 1, [3, 4, 5, 90], 'U10000001'],
    ['27492255-4c3f-11f0-8a67-9c2dcd12e445', 1, [43, 44, 50, 92], 'U10000001'],
    ['274923b4-4c3f-11f0-8a67-9c2dcd12e445', 1, [30, 31, 51, 54, 91], 'U10000001'],
    ['27492505-4c3f-11f0-8a67-9c2dcd12e445', 1, [10, 11, 51, 90], 'U10000001'],
    ['2749267d-4c3f-11f0-8a67-9c2dcd12e445', 1, [14, 15, 16, 49, 72, 91], 'U10000001'],
    ['274927e1-4c3f-11f0-8a67-9c2dcd12e445', 1, [18, 19, 49, 91], 'U10000001'],
    ['27492934-4c3f-11f0-8a67-9c2dcd12e445', 1, [37, 38, 93], 'U10000001'],
    ['27492aa1-4c3f-11f0-8a67-9c2dcd12e445', 1, [39, 40, 90], 'U10000001'],
    ['27492c0a-4c3f-11f0-8a67-9c2dcd12e445', 1, [87, 88, 93], 'U10000001'],
    ['27492d7c-4c3f-11f0-8a67-9c2dcd12e445', 1, [57, 58, 59, 51, 92], 'U10000001'],
    ['27492edf-4c3f-11f0-8a67-9c2dcd12e445', 1, [2, 35, 36, 93], 'U10000001'],
    ['2749302e-4c3f-11f0-8a67-9c2dcd12e445', 1, [45, 46, 50, 91], 'U10000001'],
    ['274931a1-4c3f-11f0-8a67-9c2dcd12e445', 1, [47, 48, 50, 90], 'U10000001'],
    ['274932e7-4c3f-11f0-8a67-9c2dcd12e445', 1, [20, 21, 49, 91], 'U10000001'],
    ['2749345c-4c3f-11f0-8a67-9c2dcd12e445', 1, [24, 49, 91], 'U10000001'],
    ['274935ad-4c3f-11f0-8a67-9c2dcd12e445', 1, [26, 27, 49, 91], 'U10000001'],
    ['27493701-4c3f-11f0-8a67-9c2dcd12e445', 1, [52, 53, 49, 73, 92], 'U10000001'],
    ['27493847-4c3f-11f0-8a67-9c2dcd12e445', 1, [61, 51, 91], 'U10000001'],
    ['27493995-4c3f-11f0-8a67-9c2dcd12e445', 1, [49, 67, 78, 90], 'U10000001'],
    ['27493b23-4c3f-11f0-8a67-9c2dcd12e445', 1, [49, 79, 81, 91], 'U10000001'],
    ['27493c6f-4c3f-11f0-8a67-9c2dcd12e445', 1, [17, 49, 92], 'U10000001'],
    ['274b346c-4c3f-11f0-8a67-9c2dcd12e445', 2, [110, 130, 139, 154], 'U10000001'],
    ['274b3b78-4c3f-11f0-8a67-9c2dcd12e445', 2, [111, 130, 152], 'U10000001'],
    ['274b3dae-4c3f-11f0-8a67-9c2dcd12e445', 2, [112, 130, 131, 155], 'U10000001'],
    ['274b3fee-4c3f-11f0-8a67-9c2dcd12e445', 2, [115, 132, 133, 153], 'U10000001'],
    ['274b41b0-4c3f-11f0-8a67-9c2dcd12e445', 2, [123, 139, 154], 'U10000001'],
    ['274b436c-4c3f-11f0-8a67-9c2dcd12e445', 2, [127, 139, 154], 'U10000001'],
    ['274b4526-4c3f-11f0-8a67-9c2dcd12e445', 2, [99, 141, 143], 'U10000001'],
    ['274b46c3-4c3f-11f0-8a67-9c2dcd12e445', 2, [100, 135, 150, 153], 'U10000001'],
    ['274b4854-4c3f-11f0-8a67-9c2dcd12e445', 2, [106, 135, 148, 154], 'U10000001'],
    ['274b49fe-4c3f-11f0-8a67-9c2dcd12e445', 2, [106, 135, 149, 154], 'U10000001'],
    ['274b4bae-4c3f-11f0-8a67-9c2dcd12e445', 2, [97, 101, 142, 153], 'U10000001'],
    ['274b4d42-4c3f-11f0-8a67-9c2dcd12e445', 2, [95, 144, 154], 'U10000001'],
    ['274b4ed1-4c3f-11f0-8a67-9c2dcd12e445', 2, [113, 130, 131, 152], 'U10000001'],
    ['274b507c-4c3f-11f0-8a67-9c2dcd12e445', 2, [104, 135, 138, 154], 'U10000001'],
    ['274b522e-4c3f-11f0-8a67-9c2dcd12e445', 2, [122, 131, 140, 155], 'U10000001'],
    ['274b53c6-4c3f-11f0-8a67-9c2dcd12e445', 2, [108, 154], 'U10000001'],
    ['274b555d-4c3f-11f0-8a67-9c2dcd12e445', 2, [109, 144, 153], 'U10000001'],
    ['274b56ed-4c3f-11f0-8a67-9c2dcd12e445', 2, [124, 139, 154], 'U10000001'],
    ['274b585a-4c3f-11f0-8a67-9c2dcd12e445', 2, [135, 145, 147, 154], 'U10000001'],
    ['274b59e5-4c3f-11f0-8a67-9c2dcd12e445', 2, [121, 152], 'U10000001'],
    ['274b5b2c-4c3f-11f0-8a67-9c2dcd12e445', 2, [158, 140, 154], 'U10000001'],
    ['274b5c75-4c3f-11f0-8a67-9c2dcd12e445', 2, [143, 153], 'U10000001'],
    ['274b5dcb-4c3f-11f0-8a67-9c2dcd12e445', 2, [107, 142, 155], 'U10000001'],
    ['274b5f11-4c3f-11f0-8a67-9c2dcd12e445', 2, [161, 140, 154], 'U10000001'],
    ['274b6063-4c3f-11f0-8a67-9c2dcd12e445', 2, [102, 135, 153], 'U10000001'],
    ['274cf7b9-4c3f-11f0-8a67-9c2dcd12e445', 3, [188, 223, 204], 'U10000001'],
    ['274cfead-4c3f-11f0-8a67-9c2dcd12e445', 3, [190], 'U10000001'],
    ['274d0061-4c3f-11f0-8a67-9c2dcd12e445', 3, [192], 'U10000001'],
    ['274d01d0-4c3f-11f0-8a67-9c2dcd12e445', 3, [193, 194], 'U10000001'],
    ['274d034c-4c3f-11f0-8a67-9c2dcd12e445', 3, [196], 'U10000001'],
    ['274d04c2-4c3f-11f0-8a67-9c2dcd12e445', 3, [225], 'U10000001'],
    ['274d060f-4c3f-11f0-8a67-9c2dcd12e445', 3, [252, 33, 34], 'U10000001'],
    ['274d0759-4c3f-11f0-8a67-9c2dcd12e445', 3, [169, 661], 'U10000001'],
    ['274d08a0-4c3f-11f0-8a67-9c2dcd12e445', 3, [210, 177], 'U10000001'],
    ['274da92a-4c3f-11f0-8a67-9c2dcd12e445', 3, [166, 170, 171, 239], 'U10000001'],
    ['274dab82-4c3f-11f0-8a67-9c2dcd12e445', 3, [187, 206], 'U10000001'],
    ['274dad48-4c3f-11f0-8a67-9c2dcd12e445', 3, [221], 'U10000001'],
    ['274daf0e-4c3f-11f0-8a67-9c2dcd12e445', 3, [197], 'U10000001'],
    ['274db0b5-4c3f-11f0-8a67-9c2dcd12e445', 3, [199], 'U10000001'],
    ['274db280-4c3f-11f0-8a67-9c2dcd12e445', 3, [202], 'U10000001'],
    ['274db42e-4c3f-11f0-8a67-9c2dcd12e445', 3, [203], 'U10000001'],
    ['274db5d0-4c3f-11f0-8a67-9c2dcd12e445', 3, [214], 'U10000001'],
    ['274db765-4c3f-11f0-8a67-9c2dcd12e445', 3, [213], 'U10000001'],
    ['274db917-4c3f-11f0-8a67-9c2dcd12e445', 3, [251, 33, 34], 'U10000001'],
    ['274dbac5-4c3f-11f0-8a67-9c2dcd12e445', 3, [174, 175, 176], 'U10000001'],
    ['274dbc69-4c3f-11f0-8a67-9c2dcd12e445', 3, [208, 663], 'U10000001'],
    ['274dbe0a-4c3f-11f0-8a67-9c2dcd12e445', 3, [182, 239], 'U10000001'],
    ['274dbfbf-4c3f-11f0-8a67-9c2dcd12e445', 3, [216], 'U10000001'],
    ['274dc157-4c3f-11f0-8a67-9c2dcd12e445', 3, [238], 'U10000001'],
    ['274dc2f8-4c3f-11f0-8a67-9c2dcd12e445', 3, [242, 177, 287], 'U10000001'],
    ['274dc498-4c3f-11f0-8a67-9c2dcd12e445', 3, [253], 'U10000001'],
    ['274f2fcf-4c3f-11f0-8a67-9c2dcd12e445', 6, [547, 563, 579, 582], 'U10000001'],
    ['274f3769-4c3f-11f0-8a67-9c2dcd12e445', 6, [548, 567, 577, 601], 'U10000001'],
    ['274f394d-4c3f-11f0-8a67-9c2dcd12e445', 6, [549, 563, 580, 602], 'U10000001'],
    ['274f3ab7-4c3f-11f0-8a67-9c2dcd12e445', 6, [552, 564, 582], 'U10000001'],
    ['274f3c3d-4c3f-11f0-8a67-9c2dcd12e445', 6, [557, 573], 'U10000001'],
    ['274f3d89-4c3f-11f0-8a67-9c2dcd12e445', 6, [555, 573], 'U10000001'],
    ['274f3ed9-4c3f-11f0-8a67-9c2dcd12e445', 6, [558, 588, 625], 'U10000001'],
    ['274f402b-4c3f-11f0-8a67-9c2dcd12e445', 6, [570], 'U10000001'],
    ['274f4186-4c3f-11f0-8a67-9c2dcd12e445', 6, [550, 563, 582], 'U10000001'],
    ['274f42e3-4c3f-11f0-8a67-9c2dcd12e445', 6, [554, 565, 577], 'U10000001'],
    ['274f444a-4c3f-11f0-8a67-9c2dcd12e445', 6, [560, 564, 581, 678, 680], 'U10000001'],
    ['274f45a3-4c3f-11f0-8a67-9c2dcd12e445', 6, [575], 'U10000001'],
    ['274f4708-4c3f-11f0-8a67-9c2dcd12e445', 6, [576, 680], 'U10000001'],
    ['274f485b-4c3f-11f0-8a67-9c2dcd12e445', 6, [572, 580, 681], 'U10000001'],
    ['274f49a9-4c3f-11f0-8a67-9c2dcd12e445', 6, [564, 577, 680], 'U10000001'],
    ['274f4afb-4c3f-11f0-8a67-9c2dcd12e445', 6, [589], 'U10000001'],
    ['274fd6e1-4c3f-11f0-8a67-9c2dcd12e445', 6, [590, 630], 'U10000001'],
    ['274fd93e-4c3f-11f0-8a67-9c2dcd12e445', 6, [574], 'U10000001'],
    ['274fdac4-4c3f-11f0-8a67-9c2dcd12e445', 6, [615, 583], 'U10000001'],
    ['274fdc2b-4c3f-11f0-8a67-9c2dcd12e445', 6, [647], 'U10000001'],
    ['274fdd99-4c3f-11f0-8a67-9c2dcd12e445', 6, [569, 607, 677], 'U10000001'],
    ['274fdef1-4c3f-11f0-8a67-9c2dcd12e445', 6, [573], 'U10000001'],
    ['274fe054-4c3f-11f0-8a67-9c2dcd12e445', 6, [551, 564, 582, 579], 'U10000001'],
    ['274fe1be-4c3f-11f0-8a67-9c2dcd12e445', 6, [568, 679], 'U10000001'],
    ['274fe32a-4c3f-11f0-8a67-9c2dcd12e445', 6, [658], 'U10000001'],
    ['274fe487-4c3f-11f0-8a67-9c2dcd12e445', 6, [666, 667], 'U10000001'],
    ['275190a9-4c3f-11f0-8a67-9c2dcd12e445', 4, [315, 317, 318], 'U10000001'],
    ['27519844-4c3f-11f0-8a67-9c2dcd12e445', 4, [313, 319, 320], 'U10000001'],
    ['27519a91-4c3f-11f0-8a67-9c2dcd12e445', 4, [321], 'U10000001'],
    ['27519c32-4c3f-11f0-8a67-9c2dcd12e445', 4, [323], 'U10000001'],
    ['27519dbb-4c3f-11f0-8a67-9c2dcd12e445', 4, [324], 'U10000001'],
    ['27519f28-4c3f-11f0-8a67-9c2dcd12e445', 4, [334, 355], 'U10000001'],
    ['2751a096-4c3f-11f0-8a67-9c2dcd12e445', 4, [329], 'U10000001'],
    ['2751a1f0-4c3f-11f0-8a67-9c2dcd12e445', 4, [330], 'U10000001'],
    ['2751a350-4c3f-11f0-8a67-9c2dcd12e445', 4, [331], 'U10000001'],
    ['2751a4ab-4c3f-11f0-8a67-9c2dcd12e445', 4, [335, 353], 'U10000001'],
    ['2751a61d-4c3f-11f0-8a67-9c2dcd12e445', 4, [365], 'U10000001'],
    ['2751a76a-4c3f-11f0-8a67-9c2dcd12e445', 4, [369], 'U10000001'],
    ['2751a8c3-4c3f-11f0-8a67-9c2dcd12e445', 4, [326], 'U10000001'],
    ['2751aa2a-4c3f-11f0-8a67-9c2dcd12e445', 4, [376], 'U10000001'],
    ['2751ab95-4c3f-11f0-8a67-9c2dcd12e445', 4, [377], 'U10000001'],
    ['2751acec-4c3f-11f0-8a67-9c2dcd12e445', 4, [325], 'U10000001'],
    ['2751ae39-4c3f-11f0-8a67-9c2dcd12e445', 4, [368], 'U10000001'],
    ['2751af83-4c3f-11f0-8a67-9c2dcd12e445', 4, [339], 'U10000001'],
    ['2751b0f6-4c3f-11f0-8a67-9c2dcd12e445', 4, [358], 'U10000001'],
    ['2751b246-4c3f-11f0-8a67-9c2dcd12e445', 4, [336], 'U10000001'],
    ['2751b391-4c3f-11f0-8a67-9c2dcd12e445', 4, [340], 'U10000001'],
    ['2751b4d8-4c3f-11f0-8a67-9c2dcd12e445', 4, [382], 'U10000001'],
    ['2751b638-4c3f-11f0-8a67-9c2dcd12e445', 4, [333, 354], 'U10000001'],
    ['2751b787-4c3f-11f0-8a67-9c2dcd12e445', 4, [383], 'U10000001'],
    ['2751b8d7-4c3f-11f0-8a67-9c2dcd12e445', 4, [316], 'U10000001'],
    ['275346a7-4c3f-11f0-8a67-9c2dcd12e445', 5, [385, 415, 449], 'U10000001'],
    ['27534dcf-4c3f-11f0-8a67-9c2dcd12e445', 5, [386, 416, 525, 526], 'U10000001'],
    ['27534f84-4c3f-11f0-8a67-9c2dcd12e445', 5, [386, 416, 486], 'U10000001'],
    ['27535100-4c3f-11f0-8a67-9c2dcd12e445', 5, [397, 427, 449], 'U10000001'],
    ['2753527e-4c3f-11f0-8a67-9c2dcd12e445', 5, [398, 428, 451], 'U10000001'],
    ['275353fe-4c3f-11f0-8a67-9c2dcd12e445', 5, [401, 472], 'U10000001'],
    ['27535563-4c3f-11f0-8a67-9c2dcd12e445', 5, [412, 476], 'U10000001'],
    ['275356c1-4c3f-11f0-8a67-9c2dcd12e445', 5, [474], 'U10000001'],
    ['27535814-4c3f-11f0-8a67-9c2dcd12e445', 5, [392, 422, 491], 'U10000001'],
    ['27535980-4c3f-11f0-8a67-9c2dcd12e445', 5, [412, 477], 'U10000001'],
    ['27535b3f-4c3f-11f0-8a67-9c2dcd12e445', 5, [395, 425, 453], 'U10000001'],
    ['27535ea6-4c3f-11f0-8a67-9c2dcd12e445', 5, [385, 415, 434], 'U10000001'],
    ['275361dd-4c3f-11f0-8a67-9c2dcd12e445', 5, [540, 541], 'U10000001'],
    ['27536395-4c3f-11f0-8a67-9c2dcd12e445', 5, [507], 'U10000001'],
    ['27536519-4c3f-11f0-8a67-9c2dcd12e445', 5, [463, 531], 'U10000001'],
    ['27536690-4c3f-11f0-8a67-9c2dcd12e445', 5, [386, 416, 440], 'U10000001'],
    ['275367e6-4c3f-11f0-8a67-9c2dcd12e445', 5, [391, 421, 493], 'U10000001'],
    ['27536953-4c3f-11f0-8a67-9c2dcd12e445', 5, [461], 'U10000001'],
    ['27536ab0-4c3f-11f0-8a67-9c2dcd12e445', 5, [460, 499, 502], 'U10000001'],
    ['27536c13-4c3f-11f0-8a67-9c2dcd12e445', 5, [406, 470, 471], 'U10000001'],
    ['27536d68-4c3f-11f0-8a67-9c2dcd12e445', 5, [430], 'U10000001'],
    ['27536eb7-4c3f-11f0-8a67-9c2dcd12e445', 5, [475], 'U10000001'],
    ['2753701b-4c3f-11f0-8a67-9c2dcd12e445', 5, [432, 433], 'U10000001'],
    ['27537170-4c3f-11f0-8a67-9c2dcd12e445', 5, [386, 416], 'U10000001'],
    ['275372c9-4c3f-11f0-8a67-9c2dcd12e445', 5, [511], 'U10000001'],
]

client = chromadb.PersistentClient('../../embedding_folder')
collection_commodity = client.get_or_create_collection('commodities')
collection_tag = client.get_or_create_collection('tags')
collection_category = client.get_or_create_collection('categories')
for data in all_data:
    tag_embedding = np.zeros(2560)
    print(f"category_{data[1]}")
    category_results = collection_category.get(
        ids=[f"category_{data[1]}"],
        include=['embeddings']
    )
    category_embedding = np.array(category_results['embeddings'][0])
    for tid in data[2]:
        tag_embedding += np.array(collection_tag.get(
            where={"tag_id": tid},
            include=['embeddings']
        )['embeddings'][0])
    embedding_sum = category_embedding + tag_embedding
    embedding_sum = embedding_sum.tolist()
    collection_commodity.upsert(
        ids = [data[0]],
        embeddings = [embedding_sum],
        metadatas = [
            {
                'seller_id':data[3],
            }
        ]
    )
